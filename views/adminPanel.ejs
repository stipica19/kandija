<%- include ('partials/header.ejs') %>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js">
</script>
<style>
    .tablica{
        padding-top: 200px;
    }
</style>

<div class="tablica">
<table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Naslov</th>
        <th scope="col">Kategorija</th>
        <th scope="col">UREDI</th>
        <th scope="col">BRIÅ I</th>
      </tr>
    </thead>
    <tbody>
        <% novosti.forEach((novost)=>{%>   
      <tr>
        <th scope="row"><%= novost.naslov%></th>
        <td><%= novost.category %></td>
        <td><a href="/novosti/<%= novost._id %>/edit" class="btn btn-primary btn-lg" role="button"><span class="glyphicon glyphicon-tag"></span>  UREDI</a></td>
        <td> <button class="brisi btn btn-danger" data-id="<%= novost._id %>" value="<%= novost._id %>">Brisi</button></td>
      </tr>
      <% });%>
      
    </tbody>
    
  </table>
</div>
  
<script>
     $(document).ready(function () {
        $('.brisi').on('click', function (e) {
            e.preventDefault();
            $target = $(e.target);
            var id = $target.attr('data-id');
            console.log("ID: " + id);
            $.ajax({
                type: 'DELETE',
                url: '/novosti/delete/' + id,
                success: (response) => {
                    window.location = "/"
                },
                error: (e) => {
                    alert('error!')
                }

            });
        });

    });
</script>